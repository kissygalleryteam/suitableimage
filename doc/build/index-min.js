/*!build time : 2014-06-07 9:08:02 PM*/
KISSY.add("kg/suitableimage/2.0.0/index",function(a,b,c){var d,e,f;return d=c.all,f={el:null,image:null,width:null,height:null,cover:!0,contain:!1,lazyload:!0,position:"center",relative:!1,showDura:.5,showFunc:"easeBoth",loadingPic:null,autoResize:!0},e=function(){function c(c){var e,g,h;"string"==typeof c?c={el:c}:null!=c.length&&(c={el:c}),this.config=a.merge(f,c),e=this.config.el=d(this.config.el),null==this.config.image&&(this.config.image=e.attr("data-ks-simage")||e.attr("data-image")||e.one("img")&&e.one("img").attr("src")),null!=this.config.image&&(this.width=h=this.config.width?this.config.width:e.width(),this.height=g=this.config.height?this.config.height:e.height(),this.config.el.css("position","relative"),this.config.lazyload?(this.config.loadingPic&&e.css("background","url("+this.config.loadingPic+") center no-repeat"),this.pic=new Image,d(this.pic).css("opacity",0),this.pic.onload=function(a){return function(){return a._load.call(a,a.pic,h,g)}}(this),this.src=this.pic.src=this.config.image,this._size(this.pic,h,g)):d(e).append(b.create('<div style="width:2.0.0%;height:2.0.0%;background:url('+this.config.image+');"></div>')),this.config.autoResize&&(this.config.cover||this.config.contain)&&d(window).on("resize",function(a){return function(){var b,c;return a.width=c=a.config.width?a.config.width:e.width(),a.height=b=a.config.height?a.config.height:e.height(),c!==h||b!==g?a.resize(c,b):void 0}}(this)))}return c.prototype._load=function(a,c,e){var f;return this.config.cover||this.config.contain?f=this._size(a,c,e):(f=b.create('<div style="width:2.0.0%;height:2.0.0%;background:url('+a.src+');"></div>'),d(f).css("opacity",0)),this.config.el.css("background","none"),this.release(),d(f).appendTo(this.config.el).animate({opacity:1},this.config.showDura,this.config.showFunc)},c.prototype._size=function(a,c,e){var f;if(a.width&&a.height)return f=null,null!=document.body.style.backgroundSize?(f=b.create("<span class='suitable-image-div' style='display: block'></span>"),d(f).css({background:"url("+a.src+") "+(this.config.position?this.config.position:"center")+" no-repeat","background-size":this.config.contain?"contain":"cover",width:"2.0.0%",height:"2.0.0%",opacity:0,position:this.config.relative?"relative":"absolute",top:0,left:0})):f=this._sizeForLoser(a,c,e),f},c.prototype._sizeForLoser=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(a.width&&a.height)return r=[a.width,a.height],k=r[0],j=r[1],p=b/k,j*p>=c&&!this.config.contain?(o=b,l=j*p,n=(l-c)/2):(l=c,o=c/j*k,m=(o-b)/2),f=0===this.config.position.indexOf("center"),g=this.config.position.indexOf("center")>=3||f&&6===this.config.position.length,e=this.config.position.indexOf("bottom")>=0,h=this.config.position.indexOf("right")>=0,q=n&&!this.config.contain?-n:f?(c-l)/2:e?c-l:0,i=m&&!this.config.contain?-m:g?(b-o)/2:h?b-o:0,this.config.el.css("overflow","hidden"),d(a).css({top:q,left:i,width:o,height:l,position:this.config.relative?"relative":"absolute",opacity:0,display:"block",zoom:1}),a},c.prototype.resize=function(a,b){return(this.config.cover||this.config.contain)&&this._sizeForLoser(this.pic,a,b),this},c.prototype.release=function(){},c}()},{requires:["dom","node"]});